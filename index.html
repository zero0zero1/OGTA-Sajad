<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>OCTA - GRAM</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="https://html5up.net/dimension/assets/css/main.css">
  <style>
    body { direction: rtl; font-family: 'Cairo', sans-serif; text-align: center; }
    h1 { font-size: 2.5em; margin-top: 1em; }
    .buttons { margin: 1em 0; }
    button { padding: 10px 20px; margin: 0 10px; border: none; background-color: #0077cc; color: white; border-radius: 5px; cursor: pointer; }
    button:hover { background-color: #005fa3; }
    table { width: 100%; margin-top: 1em; border-collapse: collapse; }
    th, td { padding: 10px; border: 1px solid #ccc; }
    th { background-color: #0077cc; color: white; }
    td { background-color: #f7f7f7; }
  </style>
</head>
<body class="is-preload">
  <div id="wrapper">
    <header id="header">
      <div class="logo"><i class="fas fa-bolt"></i></div>
      <div class="content">
        <div class="inner">
          <h1>Eng - Sajad Kadhim</h1>
          <p>تشخيص الأعطال الذكي في الشبكات الضوئية - OCTA GRAM</p>
        </div>
      </div>
      <nav>
        <ul>
          <li><button onclick="loadSheet(0)">الورقة 1</button></li>
          <li><button onclick="loadSheet(1)">الورقة 2</button></li>
          <li><button onclick="loadSheet(2)">الورقة 3</button></li>
        </ul>
      </nav>
    </header>

    <div id="main">
      <article id="data">
        <h2>بيانات الأعطال</h2>
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>نوع العطل</th>
                <th>السبب المحتمل</th>
                <th>خطوات الفحص</th>
                <th>الحل النهائي</th>
              </tr>
            </thead>
            <tbody id="faultTableBody">
              <tr><td colspan="4">جاري التحميل...</td></tr>
            </tbody>
          </table>
        </div>
      </article>
    </div>

    <footer id="footer">
      <p>&copy; 2025 OCTA - GRAM. تصميم بواسطة Eng. Sajad Kadhim</p>
    </footer>
  </div>

  <script>
    const SHEETS = [
      'https://docs.google.com/spreadsheets/d/e/2PACX-1vR39W1cXr92a99T_RDr5abulfG66yPTqXQ21703PuuArM8V83yzvu5i0DTRyMpfboDwFS-pJFh1275d/pub?gid=0&single=true&output=csv',
      'https://docs.google.com/spreadsheets/d/e/2PACX-1vR39W1cXr92a99T_RDr5abulfG66yPTqXQ21703PuuArM8V83yzvu5i0DTRyMpfboDwFS-pJFh1275d/pub?gid=727241597&single=true&output=csv',
      'https://docs.google.com/spreadsheets/d/e/2PACX-1vR39W1cXr92a99T_RDr5abulfG66yPTqXQ21703PuuArM8V83yzvu5i0DTRyMpfboDwFS-pJFh1275d/pub?gid=1162139631&single=true&output=csv'
    ];

    async function loadSheet(index) {
      const url = SHEETS[index];
      const response = await fetch(url);
      const text = await response.text();
      const lines = text.trim().split("\n");
      const data = lines.slice(1).map(line => line.split(','));

      const tbody = document.getElementById('faultTableBody');
      tbody.innerHTML = data.map(row => `
        <tr>
          <td>${row[0]}</td>
          <td>${row[1]}</td>
          <td>${row[2]}</td>
          <td>${row[3]}</td>
        </tr>
      `).join('');
    }

    window.onload = () => loadSheet(0);
  </script>
</body>
</html>
